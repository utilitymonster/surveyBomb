<html>
	<head>
		<script src="/bootstrap.min.js"></script>
		<script src="/angular.min.js"></script>
		<script src="/angular-resource.min.js"></script>
		<script src="/angular-route.min.js"></script>
		<script src="/script.js"></script>
		<script src="/factories.js"></script>
		<link rel="stylesheet" type="text/css" href="/bootstrap.min.css">
	</head>
	
	<body >
		<script>
			sumoApp.controller('addController', 
				function($scope, Question, QuestionOption, $location){

					$scope.edit = false;

					if($location.url().split('/')[3]){ // id set

						$scope.edit = true;
						var id = $location.url().split('/')[3];
						
						Question.query({id: id}, function(question){
							$scope.question = question.list[0];
							angular.forEach($scope.question.questionOptions, function(qo){
								qo = new QuestionOption(qo);
							})
						});

					}else{
						$scope.question = new Question();
					}
				}
			);

		</script>
		<div class="container"  ng-app="sumoApp" ng-controller="addController">
			<nav class="navbar navbar-inverse">
				<div class="navbar-header">
					<a class="navbar-brand" ng-click="go('/admin/index')">Admin Dashboard</a>
				</div>
				<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
					<ul class="nav navbar-nav">
						<li class=""><a onClick="go('/admin/index')">View Questions</a></li>
						<li class="active"><a onClick="go('/admin/add/')">Add Question</a></li>
						<li class=""><a onClick="go('/logout')">Logout</a></li>
					</ul>
				</div>
			</nav>
			<div>
				<h1><span ng-if="edit">Edit</span><span ng-if="!edit">Add</span> Survey Question</h1>
				<form class="col-sm-12 form-horizontal">
  					<div class="form-group">
						<input type="text" class="form-control" ng-model="question.question" placeholder="Survey Question">
					</div>
					<div ng-repeat="option in question.questionOptions" >
						<div ng-hide="option.hide" class="form-group">
								<label class="col-sm-2 control-label">Option</label>
								<div class="col-sm-10 input-group">
									<input type="text" class="form-control" ng-model="option.optionText" />
									<div ng-click="option.delete()" class="input-group-addon">x</div>
								</div>
						</div>
					</div>
					<div class="text-right form-group">
						<button class="btn btn-default" ng-click="question.newOption()">Add Option</button>
						<button type="submit" class="btn btn-primary" ng-click="question.$save()">Save</button>
					</div>
				</form>
			</div>
		</div>
	</body>
</html>